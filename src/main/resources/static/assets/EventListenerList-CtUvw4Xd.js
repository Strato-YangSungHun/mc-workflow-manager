import{_ as B}from"./TableHeader.vue_vue_type_script_setup_true_lang-CYoRzghs.js";import{s as p,_ as V}from"./request-DxUF9wXt.js";import{d as I,u as h,c as W,w as S,o as D,r as v,a as m,b,e,t as x,f as C,h as $,v as M,F as q,g as A,k as R,j as Y,i as _}from"./index-BL_7jrGB.js";import{g as G,P as T}from"./ParamForm-DbilEF1z.js";const j=()=>p.get("/eventlistener/list");function z(a){return p.get("/eventlistener/"+a)}function H(a){return p.get(`/eventlistener/duplicate?eventlistenerName=${a}`)}function J(a){return p.post("/eventlistener",a)}function K(a){return p.patch(`/eventlistener/${a.eventListenerIdx}`,a)}function O(a){return p.delete(`/eventlistener/${a}`)}const Q={class:"modal",id:"eventListenerForm",tabindex:"-1"},X={class:"modal-dialog modal-lg",role:"document"},Z={class:"modal-content"},ee={class:"modal-body text-left py-4"},te={class:"mb-5"},ne={class:"row mb-3"},se={class:"grid gap-0 column-gap-3"},ae={key:1,class:"btn btn-success",style:{margin:"3px"}},oe={class:"mb-3"},le={class:"mb-3"},ie=["value"],re={class:"modal-footer"},de=I({__name:"eventListenerForm",props:{mode:{},eventListenerIdx:{}},emits:["get-event-listener-list"],setup(a,{emit:g}){const l=h(),i=a,u=g,k=W(()=>i.eventListenerIdx);S(k,async()=>{await f(),await L()}),D(async()=>{await f(),await L()});const t=v({}),s=v(!1),f=async()=>{if(i.mode==="new")t.value.eventListenerName="",t.value.eventListenerDesc="",t.value.workflowIdx=0,t.value.workflowParams=[],w.value=!1,s.value=!0;else{const{data:o}=await z(i.eventListenerIdx);t.value=o,w.value=!0,s.value=!0}},y=v([]),L=async()=>{const{data:o}=await G("N");y.value=o},w=v(!1),d=async()=>{const{data:o}=await H(t.value.eventListenerName);o?l.error("이미 사용중인 이름입니다."):(l.success("사용 가능한 이름입니다."),w.value=!0)},c=async()=>{i.mode==="new"?(t.value.workflowParams.forEach(o=>{o.paramIdx=0,o.eventListenerYn="Y"}),await E().then(()=>{u("get-event-listener-list")})):await N().then(()=>{u("get-event-listener-list")}),f()},E=async()=>{const{data:o}=await J(t.value);o?l.success("등록되었습니다."):l.error("등록 할 수 없습니다.")},N=async()=>{const{data:o}=await K(t.value);o?l.success("등록되었습니다."):l.error("등록 할 수 없습니다.")},F=()=>{w.value=!1},U=o=>{y.value.forEach(n=>{n.workflowInfo.workflowIdx===o&&(t.value.workflowParams=n.workflowParams)})};return(o,n)=>(m(),b("div",Q,[e("div",X,[e("div",Z,[n[10]||(n[10]=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1)),e("div",ee,[e("h3",te," Event Listener "+x(i.mode==="new"?"생성":"수정"),1),e("div",null,[e("div",ne,[n[6]||(n[6]=e("label",{class:"form-label required"},"Event Listener 명",-1)),e("div",se,[C(e("input",{type:"text",class:"form-control p-2 g-col-11",placeholder:"Event Listener 명을 입력하세요","onUpdate:modelValue":n[0]||(n[0]=r=>t.value.eventListenerName=r),onFocus:F},null,544),[[$,t.value.eventListenerName]]),w.value?(m(),b("button",ae,"중복 체크")):(m(),b("button",{key:0,class:"btn btn-primary chk",onClick:d,style:{margin:"3px"}},"중복 체크"))])]),e("div",oe,[n[7]||(n[7]=e("label",{class:"form-label required"},"Event Listener 설명",-1)),C(e("input",{type:"text",class:"form-control p-2 g-col-11",placeholder:"Event Listener 설명을 입력하세요","onUpdate:modelValue":n[1]||(n[1]=r=>t.value.eventListenerDesc=r)},null,512),[[$,t.value.eventListenerDesc]])]),e("div",le,[n[9]||(n[9]=e("label",{class:"form-label required"},"Workflow",-1)),C(e("select",{class:"form-select p-2 g-col-12","onUpdate:modelValue":n[2]||(n[2]=r=>t.value.workflowIdx=r),onChange:n[3]||(n[3]=r=>U(t.value.workflowIdx))},[n[8]||(n[8]=e("option",{value:0},"Select Workflow",-1)),(m(!0),b(q,null,A(y.value,(r,P)=>(m(),b("option",{value:r.workflowInfo.workflowIdx,key:P},x(r.workflowInfo.workflowName),9,ie))),128))],544),[[M,t.value.workflowIdx]])]),s.value?(m(),R(T,{key:0,popup:!1,"workflow-param-data":t.value.workflowParams,"event-listener-yn":"Y",style:{margin:"0 !important"}},null,8,["workflow-param-data"])):Y("",!0)])]),e("div",re,[e("a",{href:"#",class:"btn btn-link link-secondary","data-bs-dismiss":"modal",onClick:n[4]||(n[4]=r=>f())}," Cancel "),e("a",{href:"#",class:"btn btn-primary ms-auto","data-bs-dismiss":"modal",onClick:n[5]||(n[5]=r=>c())},x(i.mode==="new"?"생성":"수정"),1)])])])]))}}),ce={class:"modal",id:"deleteEventListener",tabindex:"-1"},ve={class:"modal-dialog modal-lg",role:"document"},ue={class:"modal-content"},me={class:"modal-body text-left py-4"},fe={class:"modal-footer"},we=I({__name:"deleteEventListener",props:{eventListenerName:{},eventListenerIdx:{}},emits:["get-event-listener-list"],setup(a,{emit:g}){const l=h(),i=a,u=g,k=async()=>{const{data:t}=await O(i.eventListenerIdx);t?l.success("삭제되었습니다."):l.error("삭제하지 못했습니다."),u("get-event-listener-list")};return(t,s)=>(m(),b("div",ce,[e("div",ve,[e("div",ue,[s[3]||(s[3]=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1)),s[4]||(s[4]=e("div",{class:"modal-status bg-danger"},null,-1)),e("div",me,[s[1]||(s[1]=e("h3",{class:"mb-5"}," Event Listener 삭제 ",-1)),e("h4",null,x(i.eventListenerName)+"을(를) 정말 삭제하시겠습니까?",1)]),e("div",fe,[s[2]||(s[2]=e("a",{href:"#",class:"btn btn-link link-secondary","data-bs-dismiss":"modal"}," Cancel ",-1)),e("a",{href:"#",class:"btn btn-primary ms-auto","data-bs-dismiss":"modal",onClick:s[0]||(s[0]=f=>k())}," 삭제 ")])])])]))}}),be={class:"card card-flush w-100"},ye=I({__name:"EventListenerList",setup(a){const g=h(),l=v([]),i=v([]);D(async()=>{f(),await u()});const u=async()=>{try{const{data:d}=await j();l.value=d,l.value.forEach(c=>{c.eventListenerUrl=k(c.eventListenerCallUrl)})}catch(d){console.log(d),g.error("데이터를 가져올 수 없습니다.")}},k=d=>window.location.origin+d,t=v(0),s=v(""),f=()=>{i.value=[{title:"Event Listener Name",field:"eventListenerName",width:"20%"},{title:"Connect Workflow Name",field:"workflowName",width:"20%"},{title:"Event Listener Desc",field:"eventListenerDesc",width:"20%"},{title:"Action URL",field:"eventListenerUrl",width:"20%"},{title:"Action",width:"20%",formatter:y,cellClick:function(d,c){const E=d.target,N=E==null?void 0:E.getAttribute("id");t.value=c.getRow().getData().eventListenerIdx,N==="edit-btn"?L.value="edit":s.value=c.getRow().getData().eventListenerName}}]},y=()=>`
  <div>
    <button
      class='btn btn-primary d-none d-sm-inline-block mr-5'
      id='edit-btn'
      data-bs-toggle='modal' 
      data-bs-target='#eventListenerForm'>
      수정
    </button>
    <button
      class='btn btn-danger d-none d-sm-inline-block'
      id='delete-btn'
      data-bs-toggle='modal' 
      data-bs-target='#deleteEventListener'>
      삭제
    </button>
  </div>`,L=v("new"),w=()=>{t.value=0,L.value="new"};return(d,c)=>(m(),b("div",be,[_(B,{"header-title":"Event Listener","new-btn-title":"New Event Listener","popup-flag":!0,"popup-target":"#eventListenerForm",onClickNewBtn:w}),_(V,{columns:i.value,"table-data":l.value},null,8,["columns","table-data"]),_(de,{mode:L.value,"event-listener-idx":t.value,onGetEventListenerList:u},null,8,["mode","event-listener-idx"]),_(we,{"event-listener-name":s.value,"event-listener-idx":t.value,onGetEventListenerList:u},null,8,["event-listener-name","event-listener-idx"])]))}});export{ye as default};
