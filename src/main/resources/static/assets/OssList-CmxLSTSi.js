import{_ as V}from"./TableHeader.vue_vue_type_script_setup_true_lang-jocPWQ42.js";import{_ as q}from"./request-CI_Q2xQH.js";import{g as M,a as G,b as z,d as W,o as j,r as H,u as J,c as K,e as Q}from"./oss-EpwHWoC9.js";import{d as D,u as I,r as i,c as X,w as N,o as L,M as Y,a as v,b as e,t as h,e as g,v as Z,F as ss,f as es,g as _,h as p,i as C}from"./index-DirmyuVA.js";const ts={class:"modal-dialog modal-xl modal-dialog-centered",role:"document"},os={class:"modal-content"},as={class:"modal-header"},ls={class:"modal-title"},ns={class:"modal-body py-4"},rs={class:"mb-3"},is={class:"grid gap-0 column-gap-3"},ds=["value"],cs={class:"row mb-3"},us={class:"mb-3"},ms={class:"mb-3"},vs={class:"row"},ps={class:"col"},bs={class:"col"},fs={class:"col mt-4 row"},ys={key:1,class:"btn btn-success col",style:{"margin-right":"3px"}},gs={key:3,class:"btn btn-success col"},ws={class:"modal-footer"},Ss=D({__name:"ossForm",props:{mode:{},ossIdx:{}},emits:["get-oss-list"],setup(k,{emit:w}){const o=I(),c=i(),u=i(),n=k,f=w,r=X(()=>n.ossIdx);N(r,async()=>{await b()}),N(()=>n.mode,async()=>{await m(n.mode)}),L(async()=>{c.value&&(u.value=new Y(c.value)),await m("init"),await b()});const t=i({}),b=async()=>{if(n.mode==="new")t.value.ossTypeIdx=0,t.value.ossName="",t.value.ossDesc="",t.value.ossUrl="",t.value.ossUsername="",t.value.ossPassword="",d.value=!1,y.value=!1;else{const{data:a}=await M(n.ossIdx);t.value=a,t.value.ossPassword=A(t.value.ossPassword),d.value=!0,y.value=!0}},S=i([]),m=async a=>{try{if(a==="new"||a==="init"){const{data:s}=await G();S.value=s}else{const{data:s}=await z();S.value=s}}catch(s){console.log(s)}},O=()=>{t.value.ossPassword="",y.value=!1},d=i(!1),x=async()=>{const a={ossName:t.value.ossName,ossUrl:t.value.ossUrl,ossUsername:t.value.ossUsername},{data:s}=await W(a);s?o.error("이미 사용중인 이름입니다."):(o.success("사용 가능한 이름입니다."),d.value=!0)},y=i(!1),T=async()=>{const a={ossUrl:t.value.ossUrl,ossUsername:t.value.ossUsername,ossPassword:P(t.value.ossPassword),ossTypeIdx:t.value.ossTypeIdx},{data:s}=await j(a);s?(o.success("사용 가능한 OSS입니다."),y.value=!0):o.error("사용 불가능한 OSS입니다.")},F=()=>{d.value=!1},U=()=>{y.value=!1},E=async()=>{if(!t.value.ossTypeIdx||t.value.ossTypeIdx===0){o.error("Please select OSS Type.");return}if(!t.value.ossName){o.error("Please enter OSS Name.");return}if(!t.value.ossDesc){o.error("Please enter OSS Description.");return}if(!t.value.ossUrl){o.error("Please enter URL.");return}if(!t.value.ossUsername){o.error("Please enter OSS ID.");return}if(!t.value.ossPassword){o.error("Please enter OSS Password.");return}if(!d.value){o.error("Please perform duplicate check.");return}if(!y.value){o.error("Please perform connection check.");return}t.value.ossPassword=P(t.value.ossPassword);let a=!1;n.mode==="new"?a=await $():a=await R(),a&&(f("get-oss-list"),b(),u.value&&(u.value.hide(),setTimeout(()=>{document.body.classList.remove("modal-open");const s=document.querySelector(".modal-backdrop");s==null||s.remove()},150)))},$=async()=>{try{const{data:a}=await H(t.value);return a?(o.success("Regist SUCCESS."),!0):(o.error("Regist FAIL."),!1)}catch{return o.error("Regist FAIL."),!1}},R=async()=>{try{const{data:a}=await J(t.value);return a?(o.success("Update SUCCESS."),!0):(o.error("Update FAIL."),!1)}catch{return o.error("Update FAIL."),!1}},P=a=>btoa(a),A=a=>atob(a);return(a,s)=>(p(),v("div",{class:"modal modal-blur fade",id:"ossForm",tabindex:"-1","aria-hidden":"true",ref_key:"modalElement",ref:c},[e("div",ts,[e("div",os,[e("div",as,[e("h3",ls,h(n.mode==="new"?"New":"Edit")+" OSS",1),s[8]||(s[8]=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),e("div",ns,[e("div",null,[e("div",rs,[s[10]||(s[10]=e("label",{class:"form-label required"},"OSS Type",-1)),e("div",is,[g(e("select",{"onUpdate:modelValue":s[0]||(s[0]=l=>t.value.ossTypeIdx=l),class:"form-select p-2 g-col-12"},[s[9]||(s[9]=e("option",{value:0},"Select OSS Type",-1)),(p(!0),v(ss,null,es(S.value,(l,B)=>(p(),v("option",{value:l.ossTypeIdx,key:B},h(l.ossTypeName),9,ds))),128))],512),[[Z,t.value.ossTypeIdx]])])]),e("div",cs,[s[11]||(s[11]=e("label",{class:"form-label required"},"OSS Name",-1)),g(e("input",{type:"text",class:"form-control p-2 g-col-11",placeholder:"Enter the OSS Name","onUpdate:modelValue":s[1]||(s[1]=l=>t.value.ossName=l),onChange:F},null,544),[[_,t.value.ossName]])]),e("div",us,[s[12]||(s[12]=e("label",{class:"form-label required"},"OSS Description",-1)),g(e("input",{type:"text",class:"form-control p-2 g-col-11",placeholder:"Enter the OSS Description","onUpdate:modelValue":s[2]||(s[2]=l=>t.value.ossDesc=l)},null,512),[[_,t.value.ossDesc]])]),e("div",ms,[s[13]||(s[13]=e("label",{class:"form-label required"},"URL",-1)),g(e("input",{type:"text",class:"form-control p-2 g-col-7",placeholder:"Enter the Server URL","onUpdate:modelValue":s[3]||(s[3]=l=>t.value.ossUrl=l),onFocus:U},null,544),[[_,t.value.ossUrl]])]),e("div",vs,[e("div",ps,[s[14]||(s[14]=e("label",{class:"form-label required"},"OSS ID",-1)),g(e("input",{type:"text",class:"form-control p-2 g-col-7",placeholder:"Enter the OSS ID","onUpdate:modelValue":s[4]||(s[4]=l=>t.value.ossUsername=l),onFocus:U},null,544),[[_,t.value.ossUsername]])]),e("div",bs,[s[15]||(s[15]=e("label",{class:"form-label required"},"OSS PW",-1)),g(e("input",{type:"password",class:"form-control p-2 g-col-11",placeholder:"Enter the OSS Password","onUpdate:modelValue":s[5]||(s[5]=l=>t.value.ossPassword=l),onClick:O,onFocus:U},null,544),[[_,t.value.ossPassword]])]),e("div",fs,[d.value?(p(),v("button",ys,"Duplicate Check")):(p(),v("button",{key:0,class:"btn btn-primary col",onClick:x,style:{"margin-right":"3px"}},"Duplicate Check")),y.value?(p(),v("button",gs,"Connection Check")):(p(),v("button",{key:2,class:"btn btn-primary col",onClick:T},"Connection Check"))])])])]),e("div",ws,[e("button",{type:"button",class:"btn btn-link link-secondary","data-bs-dismiss":"modal",onClick:s[6]||(s[6]=l=>b())}," Cancel "),e("button",{type:"button",ref:"submitBtn",class:"btn btn-primary ms-auto",onClick:s[7]||(s[7]=l=>E())},h(n.mode==="new"?"Regist":"Edit"),513)])])])],512))}}),Os={class:"modal modal-blur fade",id:"deleteOss",tabindex:"-1","aria-hidden":"true"},_s={class:"modal-dialog modal-lg modal-dialog-centered",role:"document"},ks={class:"modal-content"},Cs={class:"modal-body py-4"},hs={class:"modal-footer"},xs=D({__name:"deleteOss",props:{ossName:{},ossIdx:{}},emits:["get-oss-list"],setup(k,{emit:w}){const o=I(),c=k,u=w,n=async()=>{const{data:f}=await K(c.ossIdx);f?o.success("삭제되었습니다."):o.error("삭제하지 못했습니다."),u("get-oss-list")};return(f,r)=>(p(),v("div",Os,[e("div",_s,[e("div",ks,[r[2]||(r[2]=e("div",{class:"modal-status bg-danger"},null,-1)),r[3]||(r[3]=e("div",{class:"modal-header"},[e("h3",{class:"modal-title"},"Delete OSS"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),e("div",Cs,[e("h4",null,"Are you sure you want to delete "+h(c.ossName)+"?",1)]),e("div",hs,[r[1]||(r[1]=e("a",{href:"#",class:"btn btn-link link-secondary","data-bs-dismiss":"modal"}," Cancel ",-1)),e("a",{href:"#",class:"btn btn-primary ms-auto","data-bs-dismiss":"modal",onClick:r[0]||(r[0]=t=>n())}," Delete ")])])])]))}}),Us={class:"card card-flush w-100"},Ds={class:"card-body table-responsive"},Ts=D({__name:"OssList",setup(k){const w=I(),o=i([]),c=i([]);L(async()=>{r(),await u()});const u=async()=>{try{const{data:m}=await Q();o.value=m}catch(m){console.log(m),w.error("데이터를 가져올 수 없습니다.")}},n=i(0),f=i(""),r=()=>{c.value=[{title:"OSS Name",field:"ossName",width:"25%"},{title:"OSS Desc",field:"ossDesc",width:"25%"},{title:"URL",field:"ossUrl",width:"25%"},{title:"Action",hozAlign:"center",width:"25%",formatter:t,cellClick:function(m,O){const d=m.target,x=d==null?void 0:d.getAttribute("id");n.value=O.getRow().getData().ossIdx,x==="edit-btn"?b.value="edit":f.value=O.getRow().getData().ossName}}]},t=()=>`
  <div>
    <button
      class='btn btn-primary d-none d-sm-inline-block mr-5'
      id='edit-btn'
      data-bs-toggle='modal' 
      data-bs-target='#ossForm'>
      EDIT
    </button>
    <button
      class='btn btn-danger d-none d-sm-inline-block'
      id='delete-btn'
      data-bs-toggle='modal' 
      data-bs-target='#deleteOss'>
      DELETE
    </button>
  </div>`,b=i("new"),S=()=>{n.value=0,b.value="new"};return(m,O)=>(p(),v("div",null,[C(V,{"header-title":"OSS","new-btn-title":"New OSS","popup-flag":!0,"popup-target":"#ossForm",onClickNewBtn:S}),e("div",Us,[e("div",Ds,[C(q,{columns:c.value,"table-data":o.value},null,8,["columns","table-data"])])]),C(Ss,{mode:b.value,"oss-idx":n.value,onGetOssList:u},null,8,["mode","oss-idx"]),C(xs,{"oss-name":f.value,"oss-idx":n.value,onGetOssList:u},null,8,["oss-name","oss-idx"])]))}});export{Ts as default};
