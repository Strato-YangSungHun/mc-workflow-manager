import{_ as B,a as U}from"./Tabulator.vue_vue_type_style_index_0_lang-DuAobM9_.js";import{s as k}from"./request-DA8z9s8Q.js";import{d as T,u as C,c as q,w as M,o as $,r as c,a as i,b as e,t as N,j as A,e as h,v as j,F as E,f as G,g as x,h as w,i as W}from"./index-DwHi2I-I.js";const R=()=>k.get("/workflowStageType/list"),O=()=>k.get("/workflowStage/list");function z(a){return k.get("/workflowStage/"+a)}function H(a){return k.get(`/workflowStage/duplicate?workflowStageName=${a.workflowStageName}&workflowStageTypeName=${a.workflowStageTypeName}`)}function J(a){return k.post("/workflowStage",a)}function K(a){return k.patch(`/workflowStage/${a.workflowStageIdx}`,a)}function P(a){return k.delete(`/workflowStage/${a}`)}function Q(a){return k.get(`/workflowStage/default/script/${a}`)}const X={class:"modal",id:"workflowStageForm",tabindex:"-1"},Y={class:"modal-dialog modal-lg",role:"document"},Z={class:"modal-content"},ee=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),te={class:"modal-body text-left py-4"},oe={class:"mb-5"},ae={class:"mb-3"},le={style:{display:"flex","justify-content":"start"}},se=e("label",{class:"form-label required col"}," Workflow Stage 타입 ",-1),ne={key:0},re=e("label",null,"타입 추가",-1),ie={class:"grid gap-0 column-gap-3"},we=e("option",{value:0},"Workflow Stage 타입을 선택하세요.",-1),de=["value"],ce={class:"mb-3"},ge=e("label",{class:"form-label required"},"Workflow Stage 명",-1),fe={class:"grid gap-0 column-gap-3"},ue={class:"col"},ke={key:1,class:"btn btn-success",style:{margin:"3px"}},me={class:"mb-3"},Se=e("label",{class:"form-label required"},"Workflow Stage 설명",-1),pe={class:"mb-3"},ve=e("label",{class:"form-label required"},"Script",-1),_e={class:"modal-footer"},be=T({__name:"WorkflowStageForm",props:{mode:{},workflowStageIdx:{}},emits:["get-workflow-stage-list"],setup(a,{emit:b}){const r=C(),n=a,g=b,f=q(()=>n.workflowStageIdx);M(f,async()=>{p(),await d()}),$(async()=>{p(),await d()});const t=c({}),d=async()=>{if(n.mode==="new")t.value.workflowStageIdx=0,t.value.workflowStageTypeIdx=0,t.value.workflowStageTypeName="",t.value.workflowStageName="",t.value.workflowStageDesc="",t.value.workflowStageContent="",t.value.workflowStageOrder=0,m.value=!1,v.value=!1;else{const{data:l}=await z(n.workflowStageIdx);t.value=l,m.value=!0}},S=c([]),p=async()=>{try{const{data:l}=await R();S.value=l}catch(l){console.log(l)}},v=c(!1),u=async()=>{v.value=!v.value,t.value.workflowStageTypeIdx=0,t.value.workflowStageTypeName=""},y=async()=>{S.value.forEach(l=>{t.value.workflowStageTypeIdx===l.workflowStageTypeIdx&&(t.value.workflowStageTypeName=l.workflowStageTypeName)}),await _(t.value.workflowStageTypeName)},_=async l=>{const{data:o}=await Q(l);t.value.workflowStageContent=o[0].workflowStageContent},m=c(!1),I=async()=>{const l={workflowStageName:t.value.workflowStageName,workflowStageTypeName:t.value.workflowStageTypeName},{data:o}=await H(l);o?r.error("이미 사용중인 이름입니다."):(r.success("사용 가능한 이름입니다."),m.value=!0)},D=async()=>{n.mode==="new"?await F().then(()=>{g("get-workflow-stage-list")}):await L().then(()=>{g("get-workflow-stage-list")}),d()},F=async()=>{const{data:l}=await J(t.value);l?r.success("등록되었습니다."):r.error("등록 할 수 없습니다.")},L=async()=>{const{data:l}=await K(t.value);l?r.success("수정되었습니다."):r.error("수정 할 수 없습니다.")};return(l,o)=>(w(),i("div",X,[e("div",Y,[e("div",Z,[ee,e("div",te,[e("h3",oe," Workflow Stage "+N(n.mode==="new"?"생성":"수정"),1),e("div",null,[e("div",ae,[e("div",le,[se,n.mode==="new"?(w(),i("div",ne,[e("input",{type:"checkBox",onChange:u},null,32),re])):A("",!0)]),e("div",ie,[v.value?h((w(),i("input",{key:1,type:"text",class:"form-control p-2 g-col-12",placeholder:"추가하실 Workflow Stage 타입을 입력하세요","onUpdate:modelValue":o[1]||(o[1]=s=>t.value.workflowStageTypeName=s),onFocusout:o[2]||(o[2]=s=>_(t.value.workflowStageTypeName))},null,544)),[[x,t.value.workflowStageTypeName]]):h((w(),i("select",{key:0,"onUpdate:modelValue":o[0]||(o[0]=s=>t.value.workflowStageTypeIdx=s),class:"form-select p-2 g-col-12",onChange:y},[we,(w(!0),i(E,null,G(S.value,(s,V)=>(w(),i("option",{value:s.workflowStageTypeIdx,key:V},N(s.workflowStageTypeName),9,de))),128))],544)),[[j,t.value.workflowStageTypeIdx]])])]),e("div",ce,[ge,e("div",fe,[h(e("input",{type:"text",class:"form-control p-2 g-col-11",placeholder:"Workflow Stage 명을 입력하세요","onUpdate:modelValue":o[3]||(o[3]=s=>t.value.workflowStageName=s)},null,512),[[x,t.value.workflowStageName]]),e("div",ue,[m.value?(w(),i("button",ke,"중복 체크")):(w(),i("button",{key:0,class:"btn btn-primary chk",onClick:I},"중복 체크"))])])]),e("div",me,[Se,h(e("input",{type:"text",class:"form-control p-2 g-col-11",placeholder:"Workflow Stage 설명을 입력하세요","onUpdate:modelValue":o[4]||(o[4]=s=>t.value.workflowStageDesc=s)},null,512),[[x,t.value.workflowStageDesc]])]),e("div",pe,[ve,h(e("textarea",{rows:"10",class:"form-control p-2 g-col-11",placeholder:"스크립트 입력하세요","onUpdate:modelValue":o[5]||(o[5]=s=>t.value.workflowStageContent=s)},null,512),[[x,t.value.workflowStageContent]])])])]),e("div",_e,[e("a",{href:"#",class:"btn btn-link link-secondary","data-bs-dismiss":"modal",onClick:o[6]||(o[6]=s=>d())}," Cancel "),e("a",{href:"#",class:"btn btn-primary ms-auto","data-bs-dismiss":"modal",onClick:o[7]||(o[7]=s=>D())},N(n.mode==="new"?"생성":"수정"),1)])])])]))}}),ye={class:"modal",id:"deleteWorkflowStage",tabindex:"-1"},he={class:"modal-dialog modal-lg",role:"document"},xe={class:"modal-content"},We=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),Ne=e("div",{class:"modal-status bg-danger"},null,-1),Te={class:"modal-body text-left py-4"},Ce=e("h3",{class:"mb-5"}," Workflow Stage 삭제 ",-1),$e={class:"modal-footer"},Ie=e("a",{href:"#",class:"btn btn-link link-secondary","data-bs-dismiss":"modal"}," Cancel ",-1),De=T({__name:"DeleteWorkflowStage",props:{workflowStageName:{},workflowStageIdx:{}},emits:["get-workflow-stage-list"],setup(a,{emit:b}){const r=C(),n=a,g=b,f=async()=>{const{data:t}=await P(n.workflowStageIdx);t?r.success("삭제되었습니다."):r.error("삭제하지 못했습니다."),g("get-workflow-stage-list")};return(t,d)=>(w(),i("div",ye,[e("div",he,[e("div",xe,[We,Ne,e("div",Te,[Ce,e("h4",null,N(n.workflowStageName)+"을(를) 정말 삭제하시겠습니까?",1)]),e("div",$e,[Ie,e("a",{href:"#",class:"btn btn-primary ms-auto","data-bs-dismiss":"modal",onClick:d[0]||(d[0]=S=>f())}," 삭제 ")])])])]))}}),Fe={class:"card card-flush w-100"},Ue=T({__name:"WorkflowStageList",setup(a){const b=C(),r=c([]),n=c([]);$(async()=>{d(),await g()});const g=async()=>{try{const{data:u}=await O();r.value=u}catch(u){console.log(u),b.error("데이터를 가져올 수 없습니다.")}},f=c(0),t=c(""),d=()=>{n.value=[{title:"Stage Type",field:"workflowStageTypeName",width:500},{title:"Stage Name",field:"workflowStageName",width:500},{title:"Stage Desc",field:"workflowStageDesc",width:500},{title:"Action",width:400,formatter:S,cellClick:function(u,y){const _=u.target,m=_==null?void 0:_.getAttribute("id");f.value=y.getRow().getData().workflowStageIdx,m==="edit-btn"?p.value="edit":m==="delete-btn"&&(t.value=y.getRow().getData().workflowStageName)}}]},S=()=>`
  <div>
    <button
      class='btn btn-primary d-none d-sm-inline-block mr-5'
      id='edit-btn'
      data-bs-toggle='modal' 
      data-bs-target='#workflowStageForm'>
      수정
    </button>
    <button
      class='btn btn-danger d-none d-sm-inline-block'
      id='delete-btn'
      data-bs-toggle='modal' 
      data-bs-target='#deleteWorkflowStage'>
      삭제
    </button>
  </div>`,p=c("new"),v=()=>{f.value=0,p.value="new"};return(u,y)=>(w(),i("div",Fe,[W(U,{"header-title":"Workflow Stage","new-btn-title":"New Stage","popup-flag":!0,"popup-target":"#workflowStageForm",onClickNewBtn:v}),W(B,{columns:n.value,"table-data":r.value},null,8,["columns","table-data"]),W(be,{mode:p.value,"workflow-stage-idx":f.value,onGetWorkflowStageList:g},null,8,["mode","workflow-stage-idx"]),W(De,{"workflow-stage-name":t.value,"workflow-stage-idx":f.value,onGetWorkflowStageList:g},null,8,["workflow-stage-name","workflow-stage-idx"])]))}});export{Ue as default};
