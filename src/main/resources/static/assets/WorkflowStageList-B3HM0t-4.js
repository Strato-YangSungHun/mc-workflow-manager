import{_ as V}from"./TableHeader.vue_vue_type_script_setup_true_lang-CYoRzghs.js";import{s as k,_ as B}from"./request-DxUF9wXt.js";import{d as C,u as D,c as A,w as U,o as h,r as g,a as i,b as d,e,t as T,j as q,f as W,v as M,F as R,g as j,h as _,i as N}from"./index-BL_7jrGB.js";const G=()=>k.get("/workflowStageType/list"),O=()=>k.get("/workflowStage/list");function P(a){return k.get("/workflowStage/"+a)}function z(a){return k.get(`/workflowStage/duplicate?workflowStageName=${a.workflowStageName}&workflowStageTypeName=${a.workflowStageTypeName}`)}function H(a){return k.post("/workflowStage",a)}function J(a){return k.patch(`/workflowStage/${a.workflowStageIdx}`,a)}function K(a){return k.delete(`/workflowStage/${a}`)}function Q(a){return k.get(`/workflowStage/default/script/${a}`)}const X={class:"modal",id:"workflowStageForm",tabindex:"-1"},Y={class:"modal-dialog modal-lg",role:"document"},Z={class:"modal-content"},ee={class:"modal-body text-left py-4"},te={class:"mb-5"},oe={class:"mb-3"},ae={style:{display:"flex","justify-content":"start"}},le={key:0},se={class:"grid gap-0 column-gap-3"},ne=["value"],re={class:"mb-3"},we={class:"grid gap-0 column-gap-3"},ie={class:"col"},de={key:1,class:"btn btn-success",style:{margin:"3px"}},ge={class:"mb-3"},fe={class:"mb-3"},ce={class:"modal-footer"},ue=C({__name:"WorkflowStageForm",props:{mode:{},workflowStageIdx:{}},emits:["get-workflow-stage-list"],setup(a,{emit:b}){const w=D(),r=a,f=b,c=A(()=>r.workflowStageIdx);U(c,async()=>{p(),await l()}),h(async()=>{p(),await l()});const t=g({}),l=async()=>{if(r.mode==="new")t.value.workflowStageIdx=0,t.value.workflowStageTypeIdx=0,t.value.workflowStageTypeName="",t.value.workflowStageName="",t.value.workflowStageDesc="",t.value.workflowStageContent="",t.value.workflowStageOrder=0,m.value=!1,v.value=!1;else{const{data:s}=await P(r.workflowStageIdx);t.value=s,m.value=!0}},S=g([]),p=async()=>{try{const{data:s}=await G();S.value=s}catch(s){console.log(s)}},v=g(!1),u=async()=>{v.value=!v.value,t.value.workflowStageTypeIdx=0,t.value.workflowStageTypeName=""},x=async()=>{S.value.forEach(s=>{t.value.workflowStageTypeIdx===s.workflowStageTypeIdx&&(t.value.workflowStageTypeName=s.workflowStageTypeName)}),await y(t.value.workflowStageTypeName)},y=async s=>{const{data:o}=await Q(s);t.value.workflowStageContent=o[0].workflowStageContent},m=g(!1),I=async()=>{const s={workflowStageName:t.value.workflowStageName,workflowStageTypeName:t.value.workflowStageTypeName},{data:o}=await z(s);o?w.error("이미 사용중인 이름입니다."):(w.success("사용 가능한 이름입니다."),m.value=!0)},$=async()=>{r.mode==="new"?await E().then(()=>{f("get-workflow-stage-list")}):await F().then(()=>{f("get-workflow-stage-list")}),l()},E=async()=>{const{data:s}=await H(t.value);s?w.success("등록되었습니다."):w.error("등록 할 수 없습니다.")},F=async()=>{const{data:s}=await J(t.value);s?w.success("수정되었습니다."):w.error("수정 할 수 없습니다.")};return(s,o)=>(i(),d("div",X,[e("div",Y,[e("div",Z,[o[14]||(o[14]=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1)),e("div",ee,[e("h3",te,T(r.mode==="new"?"New":"Edit")+" Workflow Stage ",1),e("div",null,[e("div",oe,[e("div",ae,[o[9]||(o[9]=e("label",{class:"form-label required col"}," Workflow Stage Type ",-1)),r.mode==="new"?(i(),d("div",le,[e("input",{type:"checkBox",onChange:u},null,32),o[8]||(o[8]=e("label",null,"Add Workflow Type",-1))])):q("",!0)]),e("div",se,[v.value?W((i(),d("input",{key:1,type:"text",class:"form-control p-2 g-col-12",placeholder:"Please enter the Workflow Stage type you want to add","onUpdate:modelValue":o[1]||(o[1]=n=>t.value.workflowStageTypeName=n),onFocusout:o[2]||(o[2]=n=>y(t.value.workflowStageTypeName))},null,544)),[[_,t.value.workflowStageTypeName]]):W((i(),d("select",{key:0,"onUpdate:modelValue":o[0]||(o[0]=n=>t.value.workflowStageTypeIdx=n),class:"form-select p-2 g-col-12",onChange:x},[o[10]||(o[10]=e("option",{value:0},"Select Workflow Stage Type",-1)),(i(!0),d(R,null,j(S.value,(n,L)=>(i(),d("option",{value:n.workflowStageTypeIdx,key:L},T(n.workflowStageTypeName),9,ne))),128))],544)),[[M,t.value.workflowStageTypeIdx]])])]),e("div",re,[o[11]||(o[11]=e("label",{class:"form-label required"},"Workflow Stage Name",-1)),e("div",we,[W(e("input",{type:"text",class:"form-control p-2 g-col-11",placeholder:"Enter the Workflow Stage Name","onUpdate:modelValue":o[3]||(o[3]=n=>t.value.workflowStageName=n)},null,512),[[_,t.value.workflowStageName]]),e("div",ie,[m.value?(i(),d("button",de,"Duplicate Check")):(i(),d("button",{key:0,class:"btn btn-primary chk",onClick:I},"Duplicate Check"))])])]),e("div",ge,[o[12]||(o[12]=e("label",{class:"form-label required"},"Workflow Stage Description",-1)),W(e("input",{type:"text",class:"form-control p-2 g-col-11",placeholder:"Enter the Workflow Stage Description","onUpdate:modelValue":o[4]||(o[4]=n=>t.value.workflowStageDesc=n)},null,512),[[_,t.value.workflowStageDesc]])]),e("div",fe,[o[13]||(o[13]=e("label",{class:"form-label required"},"Script",-1)),W(e("textarea",{rows:"10",class:"form-control p-2 g-col-11",placeholder:"Enter the Script","onUpdate:modelValue":o[5]||(o[5]=n=>t.value.workflowStageContent=n)},null,512),[[_,t.value.workflowStageContent]])])])]),e("div",ce,[e("a",{href:"#",class:"btn btn-link link-secondary","data-bs-dismiss":"modal",onClick:o[6]||(o[6]=n=>l())}," Cancel "),e("a",{href:"#",class:"btn btn-primary ms-auto","data-bs-dismiss":"modal",onClick:o[7]||(o[7]=n=>$())},T(r.mode==="new"?"Regist":"Edit"),1)])])])]))}}),ke={class:"modal",id:"deleteWorkflowStage",tabindex:"-1"},me={class:"modal-dialog modal-lg",role:"document"},Se={class:"modal-content"},pe={class:"modal-body text-left py-4"},ve={class:"modal-footer"},ye=C({__name:"DeleteWorkflowStage",props:{workflowStageName:{},workflowStageIdx:{}},emits:["get-workflow-stage-list"],setup(a,{emit:b}){const w=D(),r=a,f=b,c=async()=>{const{data:t}=await K(r.workflowStageIdx);t?w.success("삭제되었습니다."):w.error("삭제하지 못했습니다."),f("get-workflow-stage-list")};return(t,l)=>(i(),d("div",ke,[e("div",me,[e("div",Se,[l[3]||(l[3]=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1)),l[4]||(l[4]=e("div",{class:"modal-status bg-danger"},null,-1)),e("div",pe,[l[1]||(l[1]=e("h3",{class:"mb-5"}," Delete Workflow Stage ",-1)),e("h4",null,"Are you sure you want to delete "+T(r.workflowStageName)+"?",1)]),e("div",ve,[l[2]||(l[2]=e("a",{href:"#",class:"btn btn-link link-secondary","data-bs-dismiss":"modal"}," Cancel ",-1)),e("a",{href:"#",class:"btn btn-primary ms-auto","data-bs-dismiss":"modal",onClick:l[0]||(l[0]=S=>c())}," Delete ")])])])]))}}),be={class:"card card-flush w-100"},Ne=C({__name:"WorkflowStageList",setup(a){const b=D(),w=g([]),r=g([]);h(async()=>{l(),await f()});const f=async()=>{try{const{data:u}=await O();w.value=u}catch(u){console.log(u),b.error("데이터를 가져올 수 없습니다.")}},c=g(0),t=g(""),l=()=>{r.value=[{title:"Stage Type",field:"workflowStageTypeName",width:"27%"},{title:"Stage Name",field:"workflowStageName",width:"27%"},{title:"Stage Desc",field:"workflowStageDesc",width:"26%"},{title:"Action",width:"20%",formatter:S,cellClick:function(u,x){const y=u.target,m=y==null?void 0:y.getAttribute("id");c.value=x.getRow().getData().workflowStageIdx,m==="edit-btn"?p.value="edit":m==="delete-btn"&&(t.value=x.getRow().getData().workflowStageName)}}]},S=()=>`
  <div>
    <button
      class='btn btn-primary d-none d-sm-inline-block mr-5'
      id='edit-btn'
      data-bs-toggle='modal' 
      data-bs-target='#workflowStageForm'>
      EDIT
    </button>
    <button
      class='btn btn-danger d-none d-sm-inline-block'
      id='delete-btn'
      data-bs-toggle='modal' 
      data-bs-target='#deleteWorkflowStage'>
      DELETE
    </button>
  </div>`,p=g("new"),v=()=>{c.value=0,p.value="new"};return(u,x)=>(i(),d("div",be,[N(V,{"header-title":"Workflow Stage","new-btn-title":"New Stage","popup-flag":!0,"popup-target":"#workflowStageForm",onClickNewBtn:v}),N(B,{columns:r.value,"table-data":w.value},null,8,["columns","table-data"]),N(ue,{mode:p.value,"workflow-stage-idx":c.value,onGetWorkflowStageList:f},null,8,["mode","workflow-stage-idx"]),N(ye,{"workflow-stage-name":t.value,"workflow-stage-idx":c.value,onGetWorkflowStageList:f},null,8,["workflow-stage-name","workflow-stage-idx"])]))}});export{Ne as default};
