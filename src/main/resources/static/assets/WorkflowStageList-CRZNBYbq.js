import{_ as V,a as B}from"./Tabulator.vue_vue_type_style_index_0_lang-C7rKatiE.js";import{s as k}from"./request-a_yWYQ73.js";import{d as T,u as C,c as A,w as U,o as D,r as c,a as i,b as e,t as N,j as q,e as h,v as M,F as R,f as j,g as x,h as d,i as W}from"./index-BVWm2Zu7.js";const G=()=>k.get("/workflowStageType/list"),O=()=>k.get("/workflowStage/list");function P(a){return k.get("/workflowStage/"+a)}function z(a){return k.get(`/workflowStage/duplicate?workflowStageName=${a.workflowStageName}&workflowStageTypeName=${a.workflowStageTypeName}`)}function H(a){return k.post("/workflowStage",a)}function J(a){return k.patch(`/workflowStage/${a.workflowStageIdx}`,a)}function K(a){return k.delete(`/workflowStage/${a}`)}function Q(a){return k.get(`/workflowStage/default/script/${a}`)}const X={class:"modal",id:"workflowStageForm",tabindex:"-1"},Y={class:"modal-dialog modal-lg",role:"document"},Z={class:"modal-content"},ee=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),te={class:"modal-body text-left py-4"},oe={class:"mb-5"},ae={class:"mb-3"},le={style:{display:"flex","justify-content":"start"}},se=e("label",{class:"form-label required col"}," Workflow Stage Type ",-1),ne={key:0},re=e("label",null,"Add Workflow Type",-1),ie={class:"grid gap-0 column-gap-3"},de=e("option",{value:0},"Select Workflow Stage Type",-1),we=["value"],ce={class:"mb-3"},ge=e("label",{class:"form-label required"},"Workflow Stage Name",-1),fe={class:"grid gap-0 column-gap-3"},ue={class:"col"},ke={key:1,class:"btn btn-success",style:{margin:"3px"}},me={class:"mb-3"},Se=e("label",{class:"form-label required"},"Workflow Stage Description",-1),pe={class:"mb-3"},ve=e("label",{class:"form-label required"},"Script",-1),_e={class:"modal-footer"},ye=T({__name:"WorkflowStageForm",props:{mode:{},workflowStageIdx:{}},emits:["get-workflow-stage-list"],setup(a,{emit:y}){const r=C(),n=a,g=y,f=A(()=>n.workflowStageIdx);U(f,async()=>{p(),await w()}),D(async()=>{p(),await w()});const t=c({}),w=async()=>{if(n.mode==="new")t.value.workflowStageIdx=0,t.value.workflowStageTypeIdx=0,t.value.workflowStageTypeName="",t.value.workflowStageName="",t.value.workflowStageDesc="",t.value.workflowStageContent="",t.value.workflowStageOrder=0,m.value=!1,v.value=!1;else{const{data:l}=await P(n.workflowStageIdx);t.value=l,m.value=!0}},S=c([]),p=async()=>{try{const{data:l}=await G();S.value=l}catch(l){console.log(l)}},v=c(!1),u=async()=>{v.value=!v.value,t.value.workflowStageTypeIdx=0,t.value.workflowStageTypeName=""},b=async()=>{S.value.forEach(l=>{t.value.workflowStageTypeIdx===l.workflowStageTypeIdx&&(t.value.workflowStageTypeName=l.workflowStageTypeName)}),await _(t.value.workflowStageTypeName)},_=async l=>{const{data:o}=await Q(l);t.value.workflowStageContent=o[0].workflowStageContent},m=c(!1),$=async()=>{const l={workflowStageName:t.value.workflowStageName,workflowStageTypeName:t.value.workflowStageTypeName},{data:o}=await z(l);o?r.error("이미 사용중인 이름입니다."):(r.success("사용 가능한 이름입니다."),m.value=!0)},I=async()=>{n.mode==="new"?await E().then(()=>{g("get-workflow-stage-list")}):await F().then(()=>{g("get-workflow-stage-list")}),w()},E=async()=>{const{data:l}=await H(t.value);l?r.success("등록되었습니다."):r.error("등록 할 수 없습니다.")},F=async()=>{const{data:l}=await J(t.value);l?r.success("수정되었습니다."):r.error("수정 할 수 없습니다.")};return(l,o)=>(d(),i("div",X,[e("div",Y,[e("div",Z,[ee,e("div",te,[e("h3",oe,N(n.mode==="new"?"New":"Edit")+" Workflow Stage ",1),e("div",null,[e("div",ae,[e("div",le,[se,n.mode==="new"?(d(),i("div",ne,[e("input",{type:"checkBox",onChange:u},null,32),re])):q("",!0)]),e("div",ie,[v.value?h((d(),i("input",{key:1,type:"text",class:"form-control p-2 g-col-12",placeholder:"Please enter the Workflow Stage type you want to add","onUpdate:modelValue":o[1]||(o[1]=s=>t.value.workflowStageTypeName=s),onFocusout:o[2]||(o[2]=s=>_(t.value.workflowStageTypeName))},null,544)),[[x,t.value.workflowStageTypeName]]):h((d(),i("select",{key:0,"onUpdate:modelValue":o[0]||(o[0]=s=>t.value.workflowStageTypeIdx=s),class:"form-select p-2 g-col-12",onChange:b},[de,(d(!0),i(R,null,j(S.value,(s,L)=>(d(),i("option",{value:s.workflowStageTypeIdx,key:L},N(s.workflowStageTypeName),9,we))),128))],544)),[[M,t.value.workflowStageTypeIdx]])])]),e("div",ce,[ge,e("div",fe,[h(e("input",{type:"text",class:"form-control p-2 g-col-11",placeholder:"Enter the Workflow Stage Name","onUpdate:modelValue":o[3]||(o[3]=s=>t.value.workflowStageName=s)},null,512),[[x,t.value.workflowStageName]]),e("div",ue,[m.value?(d(),i("button",ke,"Duplicate Check")):(d(),i("button",{key:0,class:"btn btn-primary chk",onClick:$},"Duplicate Check"))])])]),e("div",me,[Se,h(e("input",{type:"text",class:"form-control p-2 g-col-11",placeholder:"Enter the Workflow Stage Description","onUpdate:modelValue":o[4]||(o[4]=s=>t.value.workflowStageDesc=s)},null,512),[[x,t.value.workflowStageDesc]])]),e("div",pe,[ve,h(e("textarea",{rows:"10",class:"form-control p-2 g-col-11",placeholder:"Enter the Script","onUpdate:modelValue":o[5]||(o[5]=s=>t.value.workflowStageContent=s)},null,512),[[x,t.value.workflowStageContent]])])])]),e("div",_e,[e("a",{href:"#",class:"btn btn-link link-secondary","data-bs-dismiss":"modal",onClick:o[6]||(o[6]=s=>w())}," Cancel "),e("a",{href:"#",class:"btn btn-primary ms-auto","data-bs-dismiss":"modal",onClick:o[7]||(o[7]=s=>I())},N(n.mode==="new"?"Regist":"Edit"),1)])])])]))}}),be={class:"modal",id:"deleteWorkflowStage",tabindex:"-1"},he={class:"modal-dialog modal-lg",role:"document"},xe={class:"modal-content"},We=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),Ne=e("div",{class:"modal-status bg-danger"},null,-1),Te={class:"modal-body text-left py-4"},Ce=e("h3",{class:"mb-5"}," Delete Workflow Stage ",-1),De={class:"modal-footer"},$e=e("a",{href:"#",class:"btn btn-link link-secondary","data-bs-dismiss":"modal"}," Cancel ",-1),Ie=T({__name:"DeleteWorkflowStage",props:{workflowStageName:{},workflowStageIdx:{}},emits:["get-workflow-stage-list"],setup(a,{emit:y}){const r=C(),n=a,g=y,f=async()=>{const{data:t}=await K(n.workflowStageIdx);t?r.success("삭제되었습니다."):r.error("삭제하지 못했습니다."),g("get-workflow-stage-list")};return(t,w)=>(d(),i("div",be,[e("div",he,[e("div",xe,[We,Ne,e("div",Te,[Ce,e("h4",null,"Are you sure you want to delete "+N(n.workflowStageName)+"?",1)]),e("div",De,[$e,e("a",{href:"#",class:"btn btn-primary ms-auto","data-bs-dismiss":"modal",onClick:w[0]||(w[0]=S=>f())}," Delete ")])])])]))}}),Ee={class:"card card-flush w-100"},Be=T({__name:"WorkflowStageList",setup(a){const y=C(),r=c([]),n=c([]);D(async()=>{w(),await g()});const g=async()=>{try{const{data:u}=await O();r.value=u}catch(u){console.log(u),y.error("데이터를 가져올 수 없습니다.")}},f=c(0),t=c(""),w=()=>{n.value=[{title:"Stage Type",field:"workflowStageTypeName",width:500},{title:"Stage Name",field:"workflowStageName",width:500},{title:"Stage Desc",field:"workflowStageDesc",width:500},{title:"Action",width:400,formatter:S,cellClick:function(u,b){const _=u.target,m=_==null?void 0:_.getAttribute("id");f.value=b.getRow().getData().workflowStageIdx,m==="edit-btn"?p.value="edit":m==="delete-btn"&&(t.value=b.getRow().getData().workflowStageName)}}]},S=()=>`
  <div>
    <button
      class='btn btn-primary d-none d-sm-inline-block mr-5'
      id='edit-btn'
      data-bs-toggle='modal' 
      data-bs-target='#workflowStageForm'>
      EDIT
    </button>
    <button
      class='btn btn-danger d-none d-sm-inline-block'
      id='delete-btn'
      data-bs-toggle='modal' 
      data-bs-target='#deleteWorkflowStage'>
      DELETE
    </button>
  </div>`,p=c("new"),v=()=>{f.value=0,p.value="new"};return(u,b)=>(d(),i("div",Ee,[W(B,{"header-title":"Workflow Stage","new-btn-title":"New Stage","popup-flag":!0,"popup-target":"#workflowStageForm",onClickNewBtn:v}),W(V,{columns:n.value,"table-data":r.value},null,8,["columns","table-data"]),W(ye,{mode:p.value,"workflow-stage-idx":f.value,onGetWorkflowStageList:g},null,8,["mode","workflow-stage-idx"]),W(Ie,{"workflow-stage-name":t.value,"workflow-stage-idx":f.value,onGetWorkflowStageList:g},null,8,["workflow-stage-name","workflow-stage-idx"])]))}});export{Be as default};
