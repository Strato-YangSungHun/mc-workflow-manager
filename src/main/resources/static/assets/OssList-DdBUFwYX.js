import{_ as B,a as q}from"./Tabulator.vue_vue_type_style_index_0_lang-D7_tsGwS.js";import{g as R,a as A,b as M,d as G,o as W,r as j,u as z,c as H,e as J}from"./oss-BY1ImqvI.js";import{d as D,u as U,c as K,w as I,o as T,r as m,a as r,b as s,t as S,e as h,v as Q,F as X,f as Y,g as w,h as u,i as O}from"./index-6aZxCmbx.js";import"./request-CKqEXO02.js";const Z={class:"modal",id:"ossForm",tabindex:"-1"},ss={class:"modal-dialog modal-xl",role:"document"},es={class:"modal-content"},ts=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),os={class:"modal-body text-left py-4"},as={class:"mb-5"},ls={class:"mb-3"},ns=s("label",{class:"form-label required"},"OSS Type",-1),cs={class:"grid gap-0 column-gap-3"},is=s("option",{value:0},"Select OSS Type",-1),ds=["value"],rs={class:"row mb-3"},us=s("label",{class:"form-label required"},"OSS Name",-1),ms={class:"grid gap-0 column-gap-3"},ps={class:"mb-3"},vs=s("label",{class:"form-label required"},"OSS Description",-1),_s={class:"mb-3"},bs=s("label",{class:"form-label required"},"URL",-1),hs={class:"row"},fs={class:"col"},gs=s("label",{class:"form-label required"},"OSS ID",-1),ws={class:"col"},ys=s("label",{class:"form-label required"},"OSS PW",-1),Os={class:"col mt-4 row"},Ss={key:1,class:"btn btn-success col",style:{"margin-right":"3px"}},ks={key:3,class:"btn btn-success col"},xs={class:"modal-footer"},Cs=D({__name:"ossForm",props:{mode:{},ossIdx:{}},emits:["get-oss-list"],setup(y,{emit:f}){const l=U(),n=y,p=f,v=K(()=>n.ossIdx);I(v,async()=>{await d()}),I(()=>n.mode,async()=>{await b(n.mode)}),T(async()=>{await b("init"),await d()});const e=m({}),d=async()=>{if(n.mode==="new")e.value.ossTypeIdx=0,e.value.ossName="",e.value.ossDesc="",e.value.ossUrl="",e.value.ossUsername="",e.value.ossPassword="",c.value=!1,i.value=!1;else{const{data:o}=await R(n.ossIdx);e.value=o,e.value.ossPassword=E(e.value.ossPassword),c.value=!0,i.value=!0}},_=m([]),b=async o=>{try{if(o==="new"||o==="init"){const{data:t}=await A();_.value=t}else{const{data:t}=await M();_.value=t}}catch(t){console.log(t)}},k=()=>{e.value.ossPassword="",i.value=!1},c=m(!1),g=async()=>{const o={ossName:e.value.ossName,ossUrl:e.value.ossUrl,ossUsername:e.value.ossUsername},{data:t}=await G(o);t?l.error("이미 사용중인 이름입니다."):(l.success("사용 가능한 이름입니다."),c.value=!0)},i=m(!1),x=async()=>{const o={ossUrl:e.value.ossUrl,ossUsername:e.value.ossUsername,ossPassword:N(e.value.ossPassword),ossTypeIdx:e.value.ossTypeIdx},{data:t}=await W(o);t?(l.success("사용 가능한 OSS입니다."),i.value=!0):l.error("사용 불가능한 OSS입니다.")},$=()=>{c.value=!1},C=()=>{i.value=!1},L=async()=>{e.value.ossPassword=N(e.value.ossPassword),n.mode==="new"?await P().then(()=>{p("get-oss-list")}):await F().then(()=>{p("get-oss-list")}),d()},P=async()=>{const{data:o}=await j(e.value);o?l.success("등록되었습니다."):l.error("등록 할 수 없습니다.")},F=async()=>{const{data:o}=await z(e.value);o?l.success("등록되었습니다."):l.error("등록 할 수 없습니다.")},N=o=>btoa(o),E=o=>atob(o);return(o,t)=>(u(),r("div",Z,[s("div",ss,[s("div",es,[ts,s("div",os,[s("h3",as,S(n.mode==="new"?"New":"Edit")+" OSS ",1),s("div",null,[s("div",ls,[ns,s("div",cs,[h(s("select",{"onUpdate:modelValue":t[0]||(t[0]=a=>e.value.ossTypeIdx=a),class:"form-select p-2 g-col-12"},[is,(u(!0),r(X,null,Y(_.value,(a,V)=>(u(),r("option",{value:a.ossTypeIdx,key:V},S(a.ossTypeName),9,ds))),128))],512),[[Q,e.value.ossTypeIdx]])])]),s("div",rs,[us,s("div",ms,[h(s("input",{type:"text",class:"form-control p-2 g-col-11",placeholder:"Enter the OSS Name","onUpdate:modelValue":t[1]||(t[1]=a=>e.value.ossName=a),onChange:$},null,544),[[w,e.value.ossName]])])]),s("div",ps,[vs,h(s("input",{type:"text",class:"form-control p-2 g-col-11",placeholder:"Enter the OSS Description","onUpdate:modelValue":t[2]||(t[2]=a=>e.value.ossDesc=a)},null,512),[[w,e.value.ossDesc]])]),s("div",_s,[bs,h(s("input",{type:"text",class:"form-control p-2 g-col-7",placeholder:"Enter the Server URL","onUpdate:modelValue":t[3]||(t[3]=a=>e.value.ossUrl=a),onFocus:C},null,544),[[w,e.value.ossUrl]])]),s("div",hs,[s("div",fs,[gs,h(s("input",{type:"text",class:"form-control p-2 g-col-7",placeholder:"Enter the OSS ID","onUpdate:modelValue":t[4]||(t[4]=a=>e.value.ossUsername=a),onFocus:C},null,544),[[w,e.value.ossUsername]])]),s("div",ws,[ys,h(s("input",{type:"password",class:"form-control p-2 g-col-11",placeholder:"Enter the OSS Password","onUpdate:modelValue":t[5]||(t[5]=a=>e.value.ossPassword=a),onClick:k,onFocus:C},null,544),[[w,e.value.ossPassword]])]),s("div",Os,[c.value?(u(),r("button",Ss,"Duplicate Check")):(u(),r("button",{key:0,class:"btn btn-primary col",onClick:g,style:{"margin-right":"3px"}},"Duplicate Check")),i.value?(u(),r("button",ks,"Connection Check")):(u(),r("button",{key:2,class:"btn btn-primary col",onClick:x},"Connection Check"))])])])]),s("div",xs,[s("a",{href:"#",class:"btn btn-link link-secondary","data-bs-dismiss":"modal",onClick:t[6]||(t[6]=a=>d())}," Cancel "),s("a",{href:"#",class:"btn btn-primary ms-auto","data-bs-dismiss":"modal",onClick:t[7]||(t[7]=a=>L())},S(n.mode==="new"?"Regist":"Edit"),1)])])])]))}}),Ds={class:"modal",id:"deleteOss",tabindex:"-1"},Us={class:"modal-dialog modal-lg",role:"document"},Ns={class:"modal-content"},Is=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),Ts=s("div",{class:"modal-status bg-danger"},null,-1),$s={class:"modal-body text-left py-4"},Ls=s("h3",{class:"mb-5"}," Delete OSS ",-1),Ps={class:"modal-footer"},Fs=s("a",{href:"#",class:"btn btn-link link-secondary","data-bs-dismiss":"modal"}," Cancel ",-1),Es=D({__name:"deleteOss",props:{ossName:{},ossIdx:{}},emits:["get-oss-list"],setup(y,{emit:f}){const l=U(),n=y,p=f,v=async()=>{const{data:e}=await H(n.ossIdx);e?l.success("삭제되었습니다."):l.error("삭제하지 못했습니다."),p("get-oss-list")};return(e,d)=>(u(),r("div",Ds,[s("div",Us,[s("div",Ns,[Is,Ts,s("div",$s,[Ls,s("h4",null,"Are you sure you want to delete "+S(n.ossName)+"?",1)]),s("div",Ps,[Fs,s("a",{href:"#",class:"btn btn-primary ms-auto","data-bs-dismiss":"modal",onClick:d[0]||(d[0]=_=>v())}," Delete ")])])])]))}}),Vs={class:"card card-flush w-100"},Ms=D({__name:"OssList",setup(y){const f=U(),l=m([]),n=m([]);T(async()=>{d(),await p()});const p=async()=>{try{const{data:c}=await J();l.value=c}catch(c){console.log(c),f.error("데이터를 가져올 수 없습니다.")}},v=m(0),e=m(""),d=()=>{n.value=[{title:"OSS Name",field:"ossName",width:"20%"},{title:"OSS Desc",field:"ossDesc",width:"20%"},{title:"URL",field:"ossUrl",width:"40%"},{title:"Action",width:"20%",formatter:_,cellClick:function(c,g){const i=c.target,x=i==null?void 0:i.getAttribute("id");v.value=g.getRow().getData().ossIdx,x==="edit-btn"?b.value="edit":e.value=g.getRow().getData().ossName}}]},_=()=>`
  <div>
    <button
      class='btn btn-primary d-none d-sm-inline-block mr-5'
      id='edit-btn'
      data-bs-toggle='modal' 
      data-bs-target='#ossForm'>
      EDIT
    </button>
    <button
      class='btn btn-danger d-none d-sm-inline-block'
      id='delete-btn'
      data-bs-toggle='modal' 
      data-bs-target='#deleteOss'>
      DELETE
    </button>
  </div>`,b=m("new"),k=()=>{v.value=0,b.value="new"};return(c,g)=>(u(),r("div",Vs,[O(q,{"header-title":"OSS","new-btn-title":"New OSS","popup-flag":!0,"popup-target":"#ossForm",onClickNewBtn:k}),O(B,{columns:n.value,"table-data":l.value},null,8,["columns","table-data"]),O(Cs,{mode:b.value,"oss-idx":v.value,onGetOssList:p},null,8,["mode","oss-idx"]),O(Es,{"oss-name":e.value,"oss-idx":v.value,onGetOssList:p},null,8,["oss-name","oss-idx"])]))}});export{Ms as default};
