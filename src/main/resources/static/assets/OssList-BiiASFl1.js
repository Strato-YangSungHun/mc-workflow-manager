import{_ as V}from"./TableHeader.vue_vue_type_script_setup_true_lang-CtosSeSW.js";import{_ as B}from"./request-CmxyMwC5.js";import{g as q,a as A,b as M,d as G,o as W,r as j,u as z,c as H,e as J}from"./oss-Bq2sfj0Q.js";import{d as U,u as D,c as K,w as N,o as L,r as m,a as c,b as u,e,t as _,f,v as Q,F as X,g as Y,h as S,i as C}from"./index-BPhSkGh_.js";const Z={class:"modal",id:"ossForm",tabindex:"-1"},ss={class:"modal-dialog modal-xl",role:"document"},es={class:"modal-content"},ts={class:"modal-body text-left py-4"},os={class:"mb-5"},as={class:"mb-3"},ls={class:"grid gap-0 column-gap-3"},ns=["value"],is={class:"row mb-3"},ds={class:"grid gap-0 column-gap-3"},rs={class:"mb-3"},cs={class:"mb-3"},us={class:"row"},ms={class:"col"},ps={class:"col"},vs={class:"col mt-4 row"},bs={key:1,class:"btn btn-success col",style:{"margin-right":"3px"}},gs={key:3,class:"btn btn-success col"},fs={class:"modal-footer"},ws=U({__name:"ossForm",props:{mode:{},ossIdx:{}},emits:["get-oss-list"],setup(O,{emit:w}){const n=D(),i=O,p=w,v=K(()=>i.ossIdx);N(v,async()=>{await o()}),N(()=>i.mode,async()=>{await g(i.mode)}),L(async()=>{await g("init"),await o()});const t=m({}),o=async()=>{if(i.mode==="new")t.value.ossTypeIdx=0,t.value.ossName="",t.value.ossDesc="",t.value.ossUrl="",t.value.ossUsername="",t.value.ossPassword="",d.value=!1,r.value=!1;else{const{data:a}=await q(i.ossIdx);t.value=a,t.value.ossPassword=$(t.value.ossPassword),d.value=!0,r.value=!0}},b=m([]),g=async a=>{try{if(a==="new"||a==="init"){const{data:s}=await A();b.value=s}else{const{data:s}=await M();b.value=s}}catch(s){console.log(s)}},k=()=>{t.value.ossPassword="",r.value=!1},d=m(!1),y=async()=>{const a={ossName:t.value.ossName,ossUrl:t.value.ossUrl,ossUsername:t.value.ossUsername},{data:s}=await G(a);s?n.error("이미 사용중인 이름입니다."):(n.success("사용 가능한 이름입니다."),d.value=!0)},r=m(!1),x=async()=>{const a={ossUrl:t.value.ossUrl,ossUsername:t.value.ossUsername,ossPassword:I(t.value.ossPassword),ossTypeIdx:t.value.ossTypeIdx},{data:s}=await W(a);s?(n.success("사용 가능한 OSS입니다."),r.value=!0):n.error("사용 불가능한 OSS입니다.")},T=()=>{d.value=!1},h=()=>{r.value=!1},F=async()=>{t.value.ossPassword=I(t.value.ossPassword),i.mode==="new"?await P().then(()=>{p("get-oss-list")}):await E().then(()=>{p("get-oss-list")}),o()},P=async()=>{await j(t.value).then(({data:a})=>{a?n.success("Regist SUCCESS."):n.error("Regist FAIL.")})},E=async()=>{await z(t.value).then(({data:a})=>{a?n.success("Update SUCCESS."):n.error("Update FAIL.")})},I=a=>btoa(a),$=a=>atob(a);return(a,s)=>(c(),u("div",Z,[e("div",ss,[e("div",es,[s[15]||(s[15]=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1)),e("div",ts,[e("h3",os,_(i.mode==="new"?"New":"Edit")+" OSS ",1),e("div",null,[e("div",as,[s[9]||(s[9]=e("label",{class:"form-label required"},"OSS Type",-1)),e("div",ls,[f(e("select",{"onUpdate:modelValue":s[0]||(s[0]=l=>t.value.ossTypeIdx=l),class:"form-select p-2 g-col-12"},[s[8]||(s[8]=e("option",{value:0},"Select OSS Type",-1)),(c(!0),u(X,null,Y(b.value,(l,R)=>(c(),u("option",{value:l.ossTypeIdx,key:R},_(l.ossTypeName),9,ns))),128))],512),[[Q,t.value.ossTypeIdx]])])]),e("div",is,[s[10]||(s[10]=e("label",{class:"form-label required"},"OSS Name",-1)),e("div",ds,[f(e("input",{type:"text",class:"form-control p-2 g-col-11",placeholder:"Enter the OSS Name","onUpdate:modelValue":s[1]||(s[1]=l=>t.value.ossName=l),onChange:T},null,544),[[S,t.value.ossName]])])]),e("div",rs,[s[11]||(s[11]=e("label",{class:"form-label required"},"OSS Description",-1)),f(e("input",{type:"text",class:"form-control p-2 g-col-11",placeholder:"Enter the OSS Description","onUpdate:modelValue":s[2]||(s[2]=l=>t.value.ossDesc=l)},null,512),[[S,t.value.ossDesc]])]),e("div",cs,[s[12]||(s[12]=e("label",{class:"form-label required"},"URL",-1)),f(e("input",{type:"text",class:"form-control p-2 g-col-7",placeholder:"Enter the Server URL","onUpdate:modelValue":s[3]||(s[3]=l=>t.value.ossUrl=l),onFocus:h},null,544),[[S,t.value.ossUrl]])]),e("div",us,[e("div",ms,[s[13]||(s[13]=e("label",{class:"form-label required"},"OSS ID",-1)),f(e("input",{type:"text",class:"form-control p-2 g-col-7",placeholder:"Enter the OSS ID","onUpdate:modelValue":s[4]||(s[4]=l=>t.value.ossUsername=l),onFocus:h},null,544),[[S,t.value.ossUsername]])]),e("div",ps,[s[14]||(s[14]=e("label",{class:"form-label required"},"OSS PW",-1)),f(e("input",{type:"password",class:"form-control p-2 g-col-11",placeholder:"Enter the OSS Password","onUpdate:modelValue":s[5]||(s[5]=l=>t.value.ossPassword=l),onClick:k,onFocus:h},null,544),[[S,t.value.ossPassword]])]),e("div",vs,[d.value?(c(),u("button",bs,"Duplicate Check")):(c(),u("button",{key:0,class:"btn btn-primary col",onClick:y,style:{"margin-right":"3px"}},"Duplicate Check")),r.value?(c(),u("button",gs,"Connection Check")):(c(),u("button",{key:2,class:"btn btn-primary col",onClick:x},"Connection Check"))])])])]),e("div",fs,[e("a",{href:"#",class:"btn btn-link link-secondary","data-bs-dismiss":"modal",onClick:s[6]||(s[6]=l=>o())}," Cancel "),e("a",{href:"#",class:"btn btn-primary ms-auto","data-bs-dismiss":"modal",onClick:s[7]||(s[7]=l=>F())},_(i.mode==="new"?"Regist":"Edit"),1)])])])]))}}),ys={class:"modal",id:"deleteOss",tabindex:"-1"},Ss={class:"modal-dialog modal-lg",role:"document"},Os={class:"modal-content"},Cs={class:"modal-body text-left py-4"},_s={class:"modal-footer"},ks=U({__name:"deleteOss",props:{ossName:{},ossIdx:{}},emits:["get-oss-list"],setup(O,{emit:w}){const n=D(),i=O,p=w,v=async()=>{const{data:t}=await H(i.ossIdx);t?n.success("삭제되었습니다."):n.error("삭제하지 못했습니다."),p("get-oss-list")};return(t,o)=>(c(),u("div",ys,[e("div",Ss,[e("div",Os,[o[3]||(o[3]=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1)),o[4]||(o[4]=e("div",{class:"modal-status bg-danger"},null,-1)),e("div",Cs,[o[1]||(o[1]=e("h3",{class:"mb-5"}," Delete OSS ",-1)),e("h4",null,"Are you sure you want to delete "+_(i.ossName)+"?",1)]),e("div",_s,[o[2]||(o[2]=e("a",{href:"#",class:"btn btn-link link-secondary","data-bs-dismiss":"modal"}," Cancel ",-1)),e("a",{href:"#",class:"btn btn-primary ms-auto","data-bs-dismiss":"modal",onClick:o[0]||(o[0]=b=>v())}," Delete ")])])])]))}}),xs={class:"card card-flush w-100"},Ns=U({__name:"OssList",setup(O){const w=D(),n=m([]),i=m([]);L(async()=>{o(),await p()});const p=async()=>{try{const{data:d}=await J();n.value=d}catch(d){console.log(d),w.error("데이터를 가져올 수 없습니다.")}},v=m(0),t=m(""),o=()=>{i.value=[{title:"OSS Name",field:"ossName",width:"20%"},{title:"OSS Desc",field:"ossDesc",width:"20%"},{title:"URL",field:"ossUrl",width:"40%"},{title:"Action",width:"20%",formatter:b,cellClick:function(d,y){const r=d.target,x=r==null?void 0:r.getAttribute("id");v.value=y.getRow().getData().ossIdx,x==="edit-btn"?g.value="edit":t.value=y.getRow().getData().ossName}}]},b=()=>`
  <div>
    <button
      class='btn btn-primary d-none d-sm-inline-block mr-5'
      id='edit-btn'
      data-bs-toggle='modal' 
      data-bs-target='#ossForm'>
      EDIT
    </button>
    <button
      class='btn btn-danger d-none d-sm-inline-block'
      id='delete-btn'
      data-bs-toggle='modal' 
      data-bs-target='#deleteOss'>
      DELETE
    </button>
  </div>`,g=m("new"),k=()=>{v.value=0,g.value="new"};return(d,y)=>(c(),u("div",xs,[C(V,{"header-title":"OSS","new-btn-title":"New OSS","popup-flag":!0,"popup-target":"#ossForm",onClickNewBtn:k}),C(B,{columns:i.value,"table-data":n.value},null,8,["columns","table-data"]),C(ws,{mode:g.value,"oss-idx":v.value,onGetOssList:p},null,8,["mode","oss-idx"]),C(ks,{"oss-name":t.value,"oss-idx":v.value,onGetOssList:p},null,8,["oss-name","oss-idx"])]))}});export{Ns as default};
